/* Case Discussion Message Formatting - Improved text rendering and layout */
.prose {
  word-wrap: break-word;
  overflow-wrap: anywhere;
  word-break: break-word;
  white-space: pre-wrap;
  line-height: 1.6;
  user-select: text;
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;
  
  /* Prevent Unicode artifacts and display issues */
  font-feature-settings: normal;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  
  /* Hide any potential control characters or artifacts */
  unicode-bidi: embed;
  direction: ltr;
  
  /* Ensure proper text flow */
  writing-mode: horizontal-tb;
  text-orientation: mixed;
}

.prose ol {
  list-style-type: decimal;
  list-style-position: outside;
  padding-left: 1.25rem;
  margin: 0.5rem 0;
  word-break: normal;
}

.prose ul {
  list-style-type: disc;
  list-style-position: outside;
  padding-left: 1.25rem;
  margin: 0.5rem 0;
  word-break: normal;
}

.prose ol > li,
.prose ul > li {
  text-indent: 0;
  padding-left: 0;
  margin: 0.25rem 0;
  word-break: break-word;
  line-height: 1.5;
}

/* Hide empty list items to prevent orphaned bullet points */
.prose li:empty {
  display: none;
}

/* Reduce spacing for paragraphs within list items */
.prose li p {
  margin: 0.25rem 0;
}

.prose p {
  margin: 0.75rem 0;
  word-break: break-word;
  overflow-wrap: anywhere;
}

.prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
  word-break: break-word;
  overflow-wrap: anywhere;
  margin: 1rem 0 0.5rem 0;
  line-height: 1.4;
}

.prose strong {
  word-break: break-word;
  overflow-wrap: anywhere;
}

/* Prevent text selection artifacts */
.prose ::selection {
  background-color: rgba(59, 130, 246, 0.3);
  color: inherit;
}

.prose ::-moz-selection {
  background-color: rgba(59, 130, 246, 0.3);
  color: inherit;
}

/* Scoped, safe message content styling */
.cd-message-content {
  word-wrap: break-word;
  overflow-wrap: anywhere;
  word-break: break-word;
  white-space: pre-wrap;
  line-height: 1.6;
  user-select: text;
  -webkit-user-select: text;
  -moz-user-select: text;
  -ms-user-select: text;

  font-feature-settings: normal;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;

  unicode-bidi: isolate;
  direction: ltr;

  writing-mode: horizontal-tb;
  text-orientation: mixed;

  contain: content;
}

.cd-message-content ::selection {
  background-color: rgba(59, 130, 246, 0.3);
  color: inherit;
}

.cd-message-content ::-moz-selection {
  background-color: rgba(59, 130, 246, 0.3);
  color: inherit;
}

/* Compact legal text styling for Step 3 - Higher specificity overrides */
.compact-legal-text.prose ul {
  margin: 0.25rem 0 !important;
}

.compact-legal-text.prose ul > li {
  margin: 0.125rem 0 !important;
}

.compact-legal-text.prose li p {
  margin: 0.125rem 0 !important;
}

.compact-legal-text.prose p {
  margin: 0.25rem 0 !important;
}

.compact-legal-text.prose ul ul {
  margin: 0.125rem 0 !important;
}

.compact-legal-text.prose ul > li > ul > li {
  margin: 0.125rem 0 !important;
}